# 🚀 AI Writer 项目上线工作清单

## 📅 阶段一：核心功能完善（必需）

### 1. API Keys 配置
- [ ] **配置 ANTHROPIC_API_KEY**
  - 获取 Claude API Key: https://console.anthropic.com/
  - 更新 `backend/.env` 文件
  - 测试文章生成功能

- [x] **配置 GEMINI_API_KEY**
  - ✅ 已从 aiwriter 项目同步

### 2. 后端功能优化
- [ ] **实现真实的调研功能**
  - 接入真实的搜索 API（Google Search API / Bing Search API）
  - 当前只有占位实现
  - 优先级：高（影响内容质量）

- [ ] **实现 PDF 生成功能**
  - 安装 PDF 生成库（weasyprint / reportlab）
  - 实现 `_generate_pdf()` 方法
  - 当前只有占位实现
  - 优先级：中

- [ ] **优化图片生成逻辑**
  - 集成真实的 Gemini 图片生成
  - 或使用免费的 Unsplash API 作为备选
  - 当前使用占位图片
  - 优先级：中

### 3. 数据持久化
- [ ] **集成数据库**
  - 选项 A：Vercel Postgres（推荐）
  - 选项 B：Supabase
  - 选项 C：MongoDB
  - 当前使用内存存储，重启后数据丢失
  - 优先级：高

- [ ] **实现文章存储**
  - 保存生成的文章内容
  - 保存配图和元数据
  - 支持历史记录查询

### 4. 错误处理和日志
- [ ] **完善错误处理**
  - API 调用失败的重试机制
  - 友好的错误提示
  - 错误日志记录

- [ ] **添加日志系统**
  - 使用 Python logging 模块
  - 记录关键操作和错误
  - 便于线上问题排查

---

## 📅 阶段二：部署上线（必需）

### 1. 代码准备
- [ ] **更新环境变量配置**
  - 创建生产环境 `.env.production`
  - 移除开发环境配置
  - 添加生产环境特定的配置

- [ ] **优化构建配置**
  - 检查 `next.config.mjs`
  - 优化图片配置
  - 启用压缩和优化

### 2. 前端部署（Vercel）
- [ ] **连接 GitHub 仓库**
  - 创建 GitHub 仓库
  - 推送代码到 GitHub
  - 在 Vercel 导入项目

- [ ] **配置 Vercel 项目**
  - Root Directory: `frontend`
  - Framework: Next.js
  - 添加环境变量：`NEXT_PUBLIC_API_URL`

- [ ] **自定义域名（可选）**
  - 购买域名
  - 配置 DNS 记录
  - 在 Vercel 绑定域名

### 3. 后端部署（Railway / Render）
- [ ] **选择部署平台**
  - Railway: https://railway.app（推荐）
  - Render: https://render.com（备选）

- [ ] **部署后端服务**
  - 连接 GitHub 仓库
  - Root Directory: `backend`
  - 配置环境变量：
    - `ANTHROPIC_API_KEY`
    - `GEMINI_API_KEY`
    - `FRONTEND_URL`

- [ ] **配置数据库**
  - 在 Railway 创建 Redis 实例（可选）
  - 或使用 Railway 提供的数据库
  - 更新 `REDIS_URL` 环境变量

- [ ] **测试后端 API**
  - 访问部署后的健康检查接口
  - 测试文章生成 API
  - 查看 Railway 日志

### 4. CORS 配置
- [ ] **更新 CORS 设置**
  - 在 `backend/main.py` 中添加生产域名
  - 确保 Vercel 域名在允许列表中

---

## 📅 阶段三：用户体验优化（推荐）

### 1. UI/UX 优化
- [ ] **添加加载动画**
  - 优化进度条动画
  - 添加骨架屏（Skeleton Screen）
  - 改进等待体验

- [ ] **优化移动端适配**
  - 测试各种屏幕尺寸
  - 调整移动端布局
  - 优化触摸交互

- [ ] **添加暗色模式切换**
  - 虽然已经是深色主题
  - 可以添加"深黑"和"深蓝"切换

### 2. 功能增强
- [ ] **添加文章预览**
  - 生成过程中实时预览
  - 分步骤显示进度

- [ ] **添加历史记录**
  - 保存用户的生成历史
  - 支持删除和重新生成

- [ ] **添加分享功能**
  - 生成分享链接
  - 社交媒体分享按钮

### 3. 性能优化
- [ ] **添加缓存机制**
  - 相同主题的调研结果缓存
  - 减少重复 API 调用

- [ ] **优化图片加载**
  - 使用 Next.js Image 组件
  - 添加图片懒加载
  - 使用 CDN 加速

---

## 📅 阶段四：运营和监控（可选）

### 1. 监控和分析
- [ ] **添加分析工具**
  - Vercel Analytics（已集成）
  - Google Analytics
  - 监控用户行为

- [ ] **错误监控**
  - Sentry（错误追踪）
  - 记录生产环境错误

- [ ] **性能监控**
  - API 响应时间
  - 文章生成时间
  - 错误率统计

### 2. 成本控制
- [ ] **设置配额限制**
  - 每个用户每天生成数量限制
  - 防止滥用

- [ ] **优化 API 调用**
  - 使用更便宜的模型（Claude Haiku）
  - 智能缓存减少重复调用

### 3. SEO 优化
- [ ] **完善 metadata**
  - 修复 `metadataBase` 警告
  - 添加更多 SEO 元标签
  - 生成 sitemap.xml

- [ ] **添加 robots.txt**
  - 允许搜索引擎爬取
  - 指定 sitemap 位置

### 4. 内容管理
- [ ] **添加内容审核**
  - 敏感词过滤
  - 内容质量检查

- [ ] **添加报告功能**
  - 用户可以举报不当内容
  - 后台管理界面

---

## 📅 阶段五：高级功能（未来）

### 1. 用户系统
- [ ] **添加用户注册/登录**
  - 使用 Clerk / NextAuth.js
  - 支持邮箱和社交登录

- [ ] **个人中心**
  - 查看历史记录
  - 管理偏好设置
  - 下载记录

### 2. 付费功能
- [ ] **集成支付系统**
  - Stripe / 支付宝
  - 订阅制或按量付费

- [ ] **会员等级**
  - 免费用户：有限配额
  - 付费用户：无限配额 + 高级功能

### 3. 多语言支持
- [ ] **国际化**
  - 添加英文版本
  - 支持多语言切换

---

## 🐛 已知问题和优化建议

### 当前测试发现的问题

#### 1. Metadata 警告（轻微）
```
⚠ metadata.metadataBase is not set
```

**解决方案**：
```typescript
// frontend/app/layout.tsx
export const metadata: Metadata = {
  metadataBase: new URL('http://localhost:3000'), // 或生产域名
  // ... 其他配置
}
```

#### 2. 使用占位图片
**当前状态**：图片生成使用 `via.placeholder.com`
**建议**：
- 优先实现真实的 Gemini 图片生成
- 或使用 Unsplash API 提供高质量免费图片

#### 3. 内存存储
**当前状态**：重启后数据丢失
**建议**：尽快集成数据库（Vercel Postgres）

#### 4. 调研功能简化
**当前状态**：只有占位实现
**建议**：接入真实搜索 API，或使用 Tavily API

---

## 📊 优先级排序

### 🔴 高优先级（上线前必须完成）
1. 配置 ANTHROPIC_API_KEY
2. 集成数据库（Vercel Postgres）
3. 实现真实的调研功能
4. 部署到生产环境（Vercel + Railway）

### 🟡 中优先级（上线后优化）
1. 实现 PDF 生成
2. 优化图片生成
3. 完善错误处理
4. 添加缓存机制

### 🟢 低优先级（长期优化）
1. 添加用户系统
2. 实现付费功能
3. 多语言支持
4. 高级数据分析

---

## 🎯 建议的行动计划

### 第一周：核心功能完善
- Day 1-2: 配置 API Keys，测试文章生成
- Day 3-4: 集成数据库，实现持久化
- Day 5-7: 实现真实调研功能

### 第二周：部署上线
- Day 1-2: 代码优化，准备部署
- Day 3-4: 部署到 Vercel + Railway
- Day 5-7: 测试和修复线上问题

### 第三周：优化迭代
- Day 1-3: 收集用户反馈
- Day 4-7: 优化用户体验

---

## 📝 快速启动检查清单

上线前最后一遍检查：

- [ ] API Keys 已配置且有效
- [ ] 数据库已连接并测试
- [ ] 前端在 Vercel 部署成功
- [ ] 后端在 Railway 部署成功
- [ ] 前后端可以正常通信
- [ ] CORS 配置正确
- [ ] 文章生成完整流程测试通过
- [ ] 移动端显示正常
- [ ] SEO 元信息完整
- [ ] 错误监控已配置
- [ ] 日志系统正常工作
- [ ] 成本控制措施已实施

---

**创建时间**: 2024-02-02
**最后更新**: 2024-02-02
